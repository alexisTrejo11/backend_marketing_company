# ============================================================================
# MARKETING INTERACTION - Customer interaction tracking and analytics
# ============================================================================

"""
Marketing interaction type enumeration.
"""
enum MarketingInteractionType {
  """
  Customer clicked on an advertisement
  """
  AD_CLICK

  """
  Customer viewed an advertisement
  """
  AD_VIEW

  """
  Customer opened a marketing email
  """
  EMAIL_OPEN

  """
  Customer clicked a link in a marketing email
  """
  EMAIL_CLICK

  """
  Customer visited a campaign landing page
  """
  LANDING_PAGE_VISIT

  """
  Customer submitted a form
  """
  FORM_SUBMIT

  """
  Customer engaged with social media content
  """
  SOCIAL_ENGAGEMENT

  """
  Customer registered for a webinar
  """
  WEBINAR_REGISTRATION

  """
  Customer downloaded a whitepaper or resource
  """
  WHITEPAPER_DOWNLOAD
}

"""
UTM parameters for tracking campaign sources.
"""
type UTMParametersOutput {
  """
  UTM source parameter
  """
  source: String

  """
  UTM medium parameter
  """
  medium: String

  """
  UTM campaign parameter
  """
  campaign: String

  """
  UTM content parameter
  """
  content: String

  """
  UTM term parameter
  """
  term: String
}

"""
Device information for the interaction.
"""
type DeviceInfoOutput {
  """
  Device type (desktop, mobile, tablet)
  """
  type: String

  """
  Device operating system
  """
  os: String

  """
  Browser used
  """
  browser: String
}

"""
Location information for the interaction.
"""
type LocationInfoOutput {
  """
  Country code (ISO 3166-1 alpha-2)
  """
  countryCode: String

  """
  City name
  """
  city: String
}

"""
Page information for the interaction.
"""
type PageInfoOutput {
  """
  Landing page URL
  """
  landingPageUrl: String

  """
  Referrer URL
  """
  referrerUrl: String
}

"""
Complete marketing interaction representation.
"""
type MarketingInteractionOutput {
  """
  Interaction ID
  """
  id: ID!

  """
  Campaign ID
  """
  campaignId: ID!

  """
  Customer ID
  """
  customerId: ID!

  """
  Type of interaction
  """
  interactionType: String!

  """
  Date and time of interaction
  """
  interactionDate: String!

  """
  Marketing channel ID
  """
  channelId: ID

  """
  UTM tracking parameters
  """
  utmParameters: UTMParametersOutput

  """
  Device information
  """
  deviceInfo: DeviceInfoOutput

  """
  Location information
  """
  locationInfo: LocationInfoOutput

  """
  Page information
  """
  pageInfo: PageInfoOutput

  """
  Associated deal ID if converted
  """
  dealId: ID

  """
  Conversion value if converted
  """
  conversionValue: Float

  """
  Whether this interaction resulted in a conversion
  """
  isConversion: Boolean!

  """
  Date and time when conversion occurred
  """
  conversionDate: String

  """
  Notes about the conversion
  """
  conversionNotes: String

  """
  Session ID for grouping interactions
  """
  sessionId: String

  """
  Additional properties as JSON
  """
  properties: JSON

  """
  Creation timestamp
  """
  createdAt: String!

  """
  Last update timestamp
  """
  updatedAt: String
}

"""
Country-level interaction count.
"""
type CountryCount {
  """
  Country code
  """
  countryCode: String!

  """
  Number of interactions
  """
  count: Int!
}

"""
City-level interaction count.
"""
type CityCount {
  """
  City name
  """
  city: String!

  """
  Number of interactions
  """
  count: Int!
}

"""
Geographic breakdown of interactions.
"""
type GeographicBreakdownResponse {
  """
  Top countries by interaction count
  """
  topCountries: [CountryCount!]!

  """
  Top cities by interaction count
  """
  topCities: [CityCount!]!
}

"""
Device type breakdown of interactions.
"""
type DeviceBreakdownResponse {
  """
  Desktop interactions
  """
  desktop: Int!

  """
  Mobile interactions
  """
  mobile: Int!

  """
  Tablet interactions
  """
  tablet: Int!

  """
  Unknown device type interactions
  """
  unknown: Int!
}

"""
Interaction type breakdown.
"""
type TypeBreakdownResponse {
  """
  Ad click interactions
  """
  adClicks: Int!

  """
  Ad view interactions
  """
  adViews: Int!

  """
  Email open interactions
  """
  emailOpens: Int!

  """
  Email click interactions
  """
  emailClicks: Int!

  """
  Landing page visit interactions
  """
  landingPageVisits: Int!

  """
  Form submission interactions
  """
  formSubmits: Int!

  """
  Social engagement interactions
  """
  socialEngagements: Int!

  """
  Webinar registration interactions
  """
  webinarRegistrations: Int!

  """
  Whitepaper download interactions
  """
  whitepaperDownloads: Int!
}

"""
Marketing interaction statistics for a campaign.
"""
type InteractionStatisticsOutput {
  """
  Campaign ID
  """
  campaignId: ID!

  """
  Campaign name
  """
  campaignName: String

  """
  Total number of interactions
  """
  totalInteractions: Int!

  """
  Total number of conversions
  """
  totalConversions: Int!

  """
  Conversion rate percentage
  """
  conversionRate: Float!

  """
  Total value of all conversions
  """
  totalConversionValue: Float!

  """
  Average value per conversion
  """
  averageConversionValue: Float!

  """
  Number of unique customers who interacted
  """
  uniqueCustomers: Int!

  """
  Number of unique channels used
  """
  uniqueChannels: Int!

  """
  Breakdown by interaction type
  """
  typeBreakdown: TypeBreakdownResponse!

  """
  Breakdown by device type
  """
  deviceBreakdown: DeviceBreakdownResponse!

  """
  Breakdown by geography
  """
  geographicBreakdown: GeographicBreakdownResponse!
}

"""
Paginated marketing interaction response.
"""
type MarketingInteractionPage implements PageResponse {
  """
  List of interactions
  """
  items: [MarketingInteractionOutput!]!

  """
  Pagination metadata
  """
  pagination: PaginationMetadata!
}

"""
Input to track a marketing interaction.
"""
input TrackInteractionInput {
  """
  Campaign ID
  """
  campaignId: ID!

  """
  Customer ID
  """
  customerId: ID!

  """
  Type of interaction
  """
  interactionType: MarketingInteractionType!

  """
  Session ID for grouping interactions
  """
  sessionId: String

  """
  Marketing channel ID
  """
  channelId: ID

  """
  UTM source parameter
  """
  utmSource: String

  """
  UTM medium parameter
  """
  utmMedium: String

  """
  UTM campaign parameter
  """
  utmCampaign: String

  """
  UTM content parameter
  """
  utmContent: String

  """
  UTM term parameter
  """
  utmTerm: String

  """
  Device type (desktop, mobile, tablet)
  """
  deviceType: String

  """
  Device operating system
  """
  deviceOs: String

  """
  Browser used
  """
  browser: String

  """
  Country code (ISO 3166-1 alpha-2)
  """
  countryCode: String

  """
  City name
  """
  city: String

  """
  Landing page URL
  """
  landingPageUrl: String

  """
  Referrer URL
  """
  referrerUrl: String

  """
  Additional properties as JSON string
  """
  properties: String
}

"""
Input to mark an interaction as a conversion.
"""
input MarkConversionInput {
  """
  Interaction ID to mark as conversion
  """
  interactionId: ID!

  """
  Deal ID associated with conversion
  """
  dealId: ID!

  """
  Conversion value amount
  """
  conversionValue: Float!

  """
  Notes about the conversion
  """
  notes: String
}

"""
Input to revert a conversion.
"""
input RevertConversionInput {
  """
  Interaction ID to revert conversion
  """
  interactionId: ID!

  """
  Reason for reverting the conversion
  """
  reason: String!

  """
  User who is reverting the conversion
  """
  revertedBy: String
}

"""
Input to update conversion value.
"""
input UpdateConversionValueInput {
  """
  Interaction ID
  """
  interactionId: ID!

  """
  New conversion value
  """
  newValue: Float!

  """
  Reason for updating the value
  """
  reason: String!

  """
  User who is updating the value
  """
  updatedBy: String
}

"""
Input to update UTM parameters.
"""
input UpdateUTMParametersInput {
  """
  Interaction ID
  """
  interactionId: ID!

  """
  UTM source parameter
  """
  utmSource: String

  """
  UTM medium parameter
  """
  utmMedium: String

  """
  UTM campaign parameter
  """
  utmCampaign: String

  """
  UTM content parameter
  """
  utmContent: String

  """
  UTM term parameter
  """
  utmTerm: String

  """
  User who is updating
  """
  updatedBy: String
}

"""
Input to update device information.
"""
input UpdateDeviceInfoInput {
  """
  Interaction ID
  """
  interactionId: ID!

  """
  Device type
  """
  deviceType: String

  """
  Device operating system
  """
  deviceOs: String

  """
  Browser
  """
  browser: String

  """
  User who is updating
  """
  updatedBy: String
}

"""
Input to update location information.
"""
input UpdateLocationInfoInput {
  """
  Interaction ID
  """
  interactionId: ID!

  """
  Country code (ISO 3166-1 alpha-2)
  """
  countryCode: String

  """
  City name
  """
  city: String

  """
  User who is updating
  """
  updatedBy: String
}

"""
Input to update page information.
"""
input UpdatePageInfoInput {
  """
  Interaction ID
  """
  interactionId: ID!

  """
  Landing page URL
  """
  landingPageUrl: String

  """
  Referrer URL
  """
  referrerUrl: String

  """
  User who is updating
  """
  updatedBy: String
}

"""
Input to update or add a custom property.
"""
input UpdatePropertyInput {
  """
  Interaction ID
  """
  interactionId: ID!

  """
  Property key
  """
  key: String!

  """
  Property value
  """
  value: String

  """
  User who is updating
  """
  updatedBy: String

  """
  Whether to overwrite existing property
  """
  overwrite: Boolean
}

"""
Input to remove a custom property.
"""
input RemovePropertyInput {
  """
  Interaction ID
  """
  interactionId: ID!

  """
  Property key to remove
  """
  key: String!

  """
  User who is removing
  """
  updatedBy: String
}

# ============================================================================
# QUERIES
# ============================================================================

extend type Query {
  """
  Get a marketing interaction by ID.
  """
  marketingInteraction(id: ID!): MarketingInteractionOutput

  """
  Get interactions for a specific campaign.
  """
  marketingInteractionsByCampaign(
    """
    Campaign ID
    """
    campaignId: ID!

    """
    Pagination parameters
    """
    pageInput: PageInput!
  ): MarketingInteractionPage!

  """
  Get interactions for a specific customer.
  """
  marketingInteractionsByCustomer(
    """
    Customer ID
    """
    customerId: ID!

    """
    Pagination parameters
    """
    pageInput: PageInput!
  ): MarketingInteractionPage!

  """
  Get conversions for a specific campaign.
  """
  conversionsByCampaign(
    """
    Campaign ID
    """
    campaignId: ID!

    """
    Pagination parameters
    """
    pageInput: PageInput!
  ): MarketingInteractionPage!

  """
  Get interaction statistics for a campaign.
  """
  marketingInteractionStatistics(campaignId: ID!): InteractionStatisticsOutput!
}

# ============================================================================
# MUTATIONS
# ============================================================================

extend type Mutation {
  """
  Track a new marketing interaction.
  """
  trackMarketingInteraction(
    input: TrackInteractionInput!
  ): MarketingInteractionOutput!

  """
  Mark an interaction as a conversion.
  """
  markAsConversion(input: MarkConversionInput!): MarketingInteractionOutput!

  """
  Revert a conversion back to a regular interaction.
  """
  revertConversion(input: RevertConversionInput!): MarketingInteractionOutput!

  """
  Update the conversion value of an interaction.
  """
  updateConversionValue(
    input: UpdateConversionValueInput!
  ): MarketingInteractionOutput!

  """
  Update UTM parameters of an interaction.
  """
  updateUTMParameters(
    input: UpdateUTMParametersInput!
  ): MarketingInteractionOutput!

  """
  Update device information of an interaction.
  """
  updateDeviceInfo(input: UpdateDeviceInfoInput!): MarketingInteractionOutput!

  """
  Update location information of an interaction.
  """
  updateLocationInfo(
    input: UpdateLocationInfoInput!
  ): MarketingInteractionOutput!

  """
  Update page information of an interaction.
  """
  updatePageInfo(input: UpdatePageInfoInput!): MarketingInteractionOutput!

  """
  Update or add a custom property to an interaction.
  """
  updateInteractionProperty(
    input: UpdatePropertyInput!
  ): MarketingInteractionOutput!

  """
  Remove a custom property from an interaction.
  """
  removeInteractionProperty(
    input: RemovePropertyInput!
  ): MarketingInteractionOutput!

  """
  Delete a marketing interaction.
  """
  deleteMarketingInteraction(id: ID!): Boolean!
}
